<div class="row mb-4">
  <div class="col">
    <h1 class="display-4">Dashboard</h1>
    <p class="lead">Bem-vindo, <%= current_user.name %>!</p>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-3">
    <div class="card text-white bg-info mb-3">
      <div class="card-body">
        <h5 class="card-title">Total de OS</h5>
        <p class="card-text display-4"><%= @total_orders %></p>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card text-white bg-warning mb-3">
      <div class="card-body">
        <h5 class="card-title">Pendentes</h5>
        <p class="card-text display-4"><%= @pending_orders %></p>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card text-white bg-primary mb-3">
      <div class="card-body">
        <h5 class="card-title">Em Andamento</h5>
        <p class="card-text display-4"><%= @in_progress_orders %></p>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card text-white bg-success mb-3">
      <div class="card-body">
        <h5 class="card-title">Concluídas</h5>
        <p class="card-text display-4"><%= @completed_orders %></p>
      </div>
    </div>
  </div>
</div>

<% if @overdue_orders.any? %>
<div class="row mb-4">
  <div class="col">
    <div class="alert alert-danger">
      <h5 class="alert-heading">⚠️ Ordens Atrasadas</h5>
      <p>Você tem <%= @overdue_orders.count %> ordem(ns) de serviço atrasada(s)!</p>
      <%= link_to "Ver todas", service_orders_path, class: "btn btn-sm btn-danger" %>
    </div>
  </div>
</div>
<% end %>

<div class="row">
  <div class="col">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Ordens de Serviço Recentes</h5>
        <%= link_to "Ver todas", service_orders_path, class: "btn btn-sm btn-primary" %>
      </div>
      <div class="card-body">
        <% if @recent_orders.any? %>
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Título</th>
                  <th>Status</th>
                  <th>Prioridade</th>
                  <th>Criado em</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody>
                <% @recent_orders.each do |order| %>
                  <tr>
                    <td><%= order.id %></td>
                    <td><%= link_to order.title, service_order_path(order) %></td>
                    <td>
                      <span class="badge <%= order.status_badge_class %>">
                        <%= order.status.humanize %>
                      </span>
                    </td>
                    <td>
                      <span class="badge <%= order.priority_badge_class %>">
                        <%= order.priority.humanize %>
                      </span>
                    </td>
                    <td><%= l(order.created_at, format: :short) %></td>
                    <td>
                      <%= link_to "Ver", service_order_path(order), class: "btn btn-sm btn-info" %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        <% else %>
          <p class="text-muted text-center">Nenhuma ordem de serviço encontrada.</p>
        <% end %>
      </div>
    </div>
  </div>
</div>
