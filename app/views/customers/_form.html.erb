<%= form_with(model: customer, local: true) do |f| %>
  <% if customer.errors.any? %>
    <div class="alert alert-danger">
      <h4 class="alert-heading">
        <i class="fas fa-exclamation-triangle"></i>
        <%= pluralize(customer.errors.count, "erro") %> impediram que este cliente fosse salvo:
      </h4>
      <ul class="mb-0">
        <% customer.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="row">
    <!-- Left Column -->
    <div class="col-md-6">
      <div class="card mb-3">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="fas fa-user"></i>
            Informações Básicas
          </h5>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <%= f.label :name, "Nome *", class: "form-label" %>
            <%= f.text_field :name, 
                            class: "form-control #{'is-invalid' if customer.errors[:name].any?}", 
                            required: true,
                            autofocus: true,
                            placeholder: "Nome completo do cliente" %>
            <% if customer.errors[:name].any? %>
              <div class="invalid-feedback">
                <%= customer.errors[:name].join(', ') %>
              </div>
            <% end %>
          </div>

          <div class="mb-3">
            <%= f.label :email, "Email", class: "form-label" %>
            <div class="input-group">
              <span class="input-group-text">
                <i class="fas fa-envelope"></i>
              </span>
              <%= f.email_field :email, 
                               class: "form-control #{'is-invalid' if customer.errors[:email].any?}",
                               placeholder: "email@exemplo.com" %>
              <% if customer.errors[:email].any? %>
                <div class="invalid-feedback">
                  <%= customer.errors[:email].join(', ') %>
                </div>
              <% end %>
            </div>
            <small class="form-text text-muted">Opcional, mas recomendado para envio de notificações</small>
          </div>

          <div class="mb-3">
            <%= f.label :phone, "Telefone *", class: "form-label" %>
            <div class="input-group">
              <span class="input-group-text">
                <i class="fas fa-phone"></i>
              </span>
              <%= f.text_field :phone, 
                              class: "form-control #{'is-invalid' if customer.errors[:phone].any?}",
                              required: true,
                              placeholder: "(00) 00000-0000" %>
              <% if customer.errors[:phone].any? %>
                <div class="invalid-feedback">
                  <%= customer.errors[:phone].join(', ') %>
                </div>
              <% end %>
            </div>
          </div>

          <div class="mb-3">
            <div class="form-check form-switch">
              <%= f.check_box :active, class: "form-check-input", role: "switch" %>
              <%= f.label :active, "Cliente Ativo", class: "form-check-label" %>
            </div>
            <small class="form-text text-muted">
              Clientes inativos não aparecem em listas de seleção, mas mantêm seu histórico
            </small>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column -->
    <div class="col-md-6">
      <div class="card mb-3">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="fas fa-map-marker-alt"></i>
            Endereço
          </h5>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <%= f.label :address, "Logradouro", class: "form-label" %>
            <%= f.text_field :address, 
                            class: "form-control",
                            placeholder: "Rua, Avenida, etc." %>
            <small class="form-text text-muted">Opcional</small>
          </div>

          <div class="row">
            <div class="col-md-7 mb-3">
              <%= f.label :city, "Cidade", class: "form-label" %>
              <%= f.text_field :city, 
                              class: "form-control",
                              placeholder: "Nome da cidade" %>
            </div>

            <div class="col-md-5 mb-3">
              <%= f.label :state, "Estado", class: "form-label" %>
              <%= f.select :state,
                          options_for_select([
                            ['', ''],
                            ['AC', 'AC'], ['AL', 'AL'], ['AP', 'AP'], ['AM', 'AM'],
                            ['BA', 'BA'], ['CE', 'CE'], ['DF', 'DF'], ['ES', 'ES'],
                            ['GO', 'GO'], ['MA', 'MA'], ['MT', 'MT'], ['MS', 'MS'],
                            ['MG', 'MG'], ['PA', 'PA'], ['PB', 'PB'], ['PR', 'PR'],
                            ['PE', 'PE'], ['PI', 'PI'], ['RJ', 'RJ'], ['RN', 'RN'],
                            ['RS', 'RS'], ['RO', 'RO'], ['RR', 'RR'], ['SC', 'SC'],
                            ['SP', 'SP'], ['SE', 'SE'], ['TO', 'TO']
                          ], customer.state),
                          {},
                          class: "form-select" %>
            </div>
          </div>

          <div class="mb-3">
            <%= f.label :zip_code, "CEP", class: "form-label" %>
            <%= f.text_field :zip_code, 
                            class: "form-control",
                            placeholder: "00000-000" %>
          </div>
        </div>
      </div>

      <div class="card mb-3">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="fas fa-sticky-note"></i>
            Observações
          </h5>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <%= f.text_area :notes, 
                           class: "form-control",
                           rows: 5,
                           placeholder: "Informações adicionais sobre o cliente..." %>
            <small class="form-text text-muted">
              Campo opcional para notas, preferências ou informações relevantes
            </small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Form Actions -->
  <div class="d-flex justify-content-between align-items-center mt-4">
    <small class="text-muted">* Campos obrigatórios</small>
    
    <div>
      <%= link_to "Cancelar", 
                 customer.persisted? ? customer_path(customer) : customers_path,
                 class: "btn btn-secondary" %>
      
      <%= f.submit customer.persisted? ? "Atualizar Cliente" : "Cadastrar Cliente",
                  class: "btn btn-primary" %>
    </div>
  </div>
<% end %>
